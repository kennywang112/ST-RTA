# This is for the lane in Mapper

books = { 
    ('hotspot', '車道劃分設施-分道設施-路面邊線名稱_有'): {
        'label': cond_prob_mixed,
        'avg': True,
        'params': {'a_col': 'hotspot', 'a_is': 'Hotspot',
                   'b_col': '車道劃分設施-分道設施-路面邊線名稱_有', 'b_rule': '>0'},
        'color': 'Blues',
        'en': {}
    },
    ('hotspot', '車道劃分設施-分道設施-路面邊線名稱_無'): {
        'label': cond_prob_mixed,
        'avg': True,
        'params': {'a_col': 'hotspot', 'a_is': 'Hotspot',
                   'b_col': '車道劃分設施-分道設施-路面邊線名稱_無', 'b_rule': '>0'},
        'color': 'Blues',
        'en': {}
    },
    ('hotspot', '車道劃分設施-分向設施大類別名稱_無'): {
        'label': cond_prob_mixed,
        'avg': True,
        'params': {'a_col': 'hotspot', 'a_is': 'Hotspot',
                   'b_col': '車道劃分設施-分向設施大類別名稱_無', 'b_rule': '>0'},
        'color': 'Blues',
        'en': {}
    },
    ('hotspot', '車道劃分設施-分向設施大類別名稱_雙向禁止超車線'): {
        'label': cond_prob_mixed,
        'avg': True,
        'params': {'a_col': 'hotspot', 'a_is': 'Hotspot',
                   'b_col': '車道劃分設施-分向設施大類別名稱_雙向禁止超車線', 'b_rule': '>0'},
        'color': 'Blues',
        'en': {}
    },
    ('hotspot', '車道劃分設施-分向設施大類別名稱_中央分向島'): {
        'label': cond_prob_mixed,
        'avg': True,
        'params': {'a_col': 'hotspot', 'a_is': 'Hotspot',
                   'b_col': '車道劃分設施-分向設施大類別名稱_中央分向島', 'b_rule': '>0'},
        'color': 'Blues',
        'en': {}
    },
    ('hotspot', '車道劃分設施-分向設施大類別名稱_行車分向線'): {
        'label': cond_prob_mixed,
        'avg': True,
        'params': {'a_col': 'hotspot', 'a_is': 'Hotspot',
                   'b_col': '車道劃分設施-分向設施大類別名稱_行車分向線', 'b_rule': '>0'},
        'color': 'Blues',
        'en': {}
    },
    ('hotspot', '車道劃分設施-分向設施大類別名稱_單向禁止超車線'): {
        'label': cond_prob_mixed,
        'avg': True,
        'params': {'a_col': 'hotspot', 'a_is': 'Hotspot',
                   'b_col': '車道劃分設施-分向設施大類別名稱_單向禁止超車線', 'b_rule': '>0'},
        'color': 'Blues',
        'en': {}
    },
    ('hotspot', '車道劃分設施-分道設施-快慢車道間名稱_未繪設快慢車道分隔線'): {
        'label': cond_prob_mixed,
        'avg': True,
        'params': {'a_col': 'hotspot', 'a_is': 'Hotspot',
                   'b_col': '車道劃分設施-分道設施-快慢車道間名稱_未繪設快慢車道分隔線', 'b_rule': '>0'},
        'color': 'Blues',
        'en': {}
    },
    ('hotspot', '車道劃分設施-分道設施-快慢車道間名稱_快慢車道分隔線'): {
        'label': cond_prob_mixed,
        'avg': True,
        'params': {'a_col': 'hotspot', 'a_is': 'Hotspot',
                   'b_col': '車道劃分設施-分道設施-快慢車道間名稱_快慢車道分隔線', 'b_rule': '>0'},
        'color': 'Blues',
        'en': {}
    },
    ('hotspot', '車道劃分設施-分道設施-快車道或一般車道間名稱_未繪設車道線'): {
        'label': cond_prob_mixed,
        'avg': True,
        'params': {'a_col': 'hotspot', 'a_is': 'Hotspot',
                   'b_col': '車道劃分設施-分道設施-快車道或一般車道間名稱_未繪設車道線', 'b_rule': '>0'},
        'color': 'Blues',
        'en': {}
    },
    ('hotspot', '車道劃分設施-分道設施-快車道或一般車道間名稱_車道線(無標記)'): {
        'label': cond_prob_mixed,
        'avg': True,
        'params': {'a_col': 'hotspot', 'a_is': 'Hotspot',
                   'b_col': '車道劃分設施-分道設施-快車道或一般車道間名稱_車道線(無標記)', 'b_rule': '>0'},
        'color': 'Blues',
        'en': {}
    },
    ('hotspot', '車道劃分設施-分道設施-快車道或一般車道間名稱_車道線(附標記)'): {
        'label': cond_prob_mixed,
        'avg': True,
        'params': {'a_col': 'hotspot', 'a_is': 'Hotspot',
                   'b_col': '車道劃分設施-分道設施-快車道或一般車道間名稱_車道線(附標記)', 'b_rule': '>0'},
        'color': 'Blues',
        'en': {}
    },
    ('hotspot', '車道劃分設施-分道設施-快車道或一般車道間名稱_禁止變換車道線(無標記)'): {
        'label': cond_prob_mixed,
        'avg': True,
        'params': {'a_col': 'hotspot', 'a_is': 'Hotspot',
                   'b_col': '車道劃分設施-分道設施-快車道或一般車道間名稱_禁止變換車道線(無標記)', 'b_rule': '>0'},
        'color': 'Blues',
        'en': {}
    },
    ('hotspot', '車道劃分設施-分道設施-快車道或一般車道間名稱_禁止變換車道線(附標記)'): {
        'label': cond_prob_mixed,
        'avg': True,
        'params': {'a_col': 'hotspot', 'a_is': 'Hotspot',
                   'b_col': '車道劃分設施-分道設施-快車道或一般車道間名稱_禁止變換車道線(附標記)', 'b_rule': '>0'},
        'color': 'Blues',
        'en': {}
    },
    ('hotspot', '車道劃分設施-分道設施-快慢車道間名稱_寬式快慢車道分隔島(50公分以上)'): {
        'label': cond_prob_mixed,
        'avg': True,
        'params': {'a_col': 'hotspot', 'a_is': 'Hotspot',
                   'b_col': '車道劃分設施-分道設施-快慢車道間名稱_寬式快慢車道分隔島(50公分以上)', 'b_rule': '>0'},
        'color': 'Blues',
        'en': {}
    },
    ('hotspot', '車道劃分設施-分道設施-快慢車道間名稱_窄式快慢車道分隔島(無柵欄)'): {
        'label': cond_prob_mixed,
        'avg': True,
        'params': {'a_col': 'hotspot', 'a_is': 'Hotspot',
                   'b_col': '車道劃分設施-分道設施-快慢車道間名稱_窄式快慢車道分隔島(無柵欄)', 'b_rule': '>0'},
        'color': 'Blues',
        'en': {}
    },
    ('hotspot', '車道劃分設施-分道設施-快慢車道間名稱_窄式快慢車道分隔島(附柵欄)'): {
        'label': cond_prob_mixed,
        'avg': True,
        'params': {'a_col': 'hotspot', 'a_is': 'Hotspot',
                   'b_col': '車道劃分設施-分道設施-快慢車道間名稱_窄式快慢車道分隔島(附柵欄)', 'b_rule': '>0'},
        'color': 'Blues',
        'en': {}
    },
}

all_features_df['lane_feature'] = all_features_df.apply(
    lambda row: 1 if (
        (
        (
            (row['車道劃分設施-分向設施大類別名稱_中央分向島'] > 0) or
            (row['車道劃分設施-分向設施大類別名稱_無'] > 0) or
            (row['車道劃分設施-分向設施大類別名稱_行車分向線'] > 0) or
            (row['車道劃分設施-分向設施大類別名稱_雙向禁止超車線'] > 0)
            ) or
        (
            (row['車道劃分設施-分道設施-快慢車道間名稱_快慢車道分隔線'] > 0) or
            (row['車道劃分設施-分道設施-快慢車道間名稱_未繪設快慢車道分隔線'] > 0)
            ) or
        (
            (row['車道劃分設施-分道設施-快車道或一般車道間名稱_未繪設車道線'] > 0) or
            (row['車道劃分設施-分道設施-快車道或一般車道間名稱_禁止變換車道線(無標記)'] > 0) or
            (row['車道劃分設施-分道設施-快車道或一般車道間名稱_車道線(無標記)'] > 0)
            ) or
        (
            (row['車道劃分設施-分道設施-路面邊線名稱_無'] > 0)
            )
        )
    ) else 0,
    axis=1
)